#    What is a 95% posterior credible interval for theta2?
# 7) What is the posterior probability that theta1>theta2, i.e., that the
#    first student has a better chance of getting a question right than
#    the second student?
############
# Solutions:
# 1) Parameters of interest are theta1=true probability the first student
#    will answer a question correctly, and theta2=true probability the second
#    student will answer a question correctly.
# 2) Likelihood is Binomial(40, theta), if we assume that each question is
#    independent and that the probability a student gets each question right
#    is the same for all questions for that student.
# 3) The conjugate prior is a beta prior. Plot the density with dbeta.
theta=seq(from=0,to=1,by=.01)
plot(theta,dbeta(theta,1,1),type="l")
plot(theta,dbeta(theta,4,2),type="l")
plot(theta,dbeta(theta,8,4),type="l")
# 4) Find probabilities using the pbeta function.
1-pbeta(.25,8,4)
1-pbeta(.5,8,4)
1-pbeta(.8,8,4)
# 5) Posterior is Beta(8+33,4+40-33) = Beta(41,11)
41/(41+11)  # posterior mean
33/40       # MLE
lines(theta,dbeta(theta,41,11))
# plot posterior first to get the right scale on the y-axis
plot(theta,dbeta(theta,41,11),type="l")
lines(theta,dbeta(theta,8,4),lty=2)
# plot likelihood
lines(theta,dbinom(33,size=40,p=theta),lty=3)
# plot scaled likelihood
lines(theta,44*dbinom(33,size=40,p=theta),lty=3)
# posterior probabilities
1-pbeta(.25,41,11)
1-pbeta(.5,41,11)
1-pbeta(.8,41,11)
# equal-tailed 95% credible interval
qbeta(.025,41,11)
qbeta(.975,41,11)
# 6) Posterior is Beta(8+24,4+40-24) = Beta(32,20)
32/(32+20)  # posterior mean
24/40       # MLE
plot(theta,dbeta(theta,32,20),type="l")
lines(theta,dbeta(theta,8,4),lty=2)
lines(theta,44*dbinom(24,size=40,p=theta),lty=3)
1-pbeta(.25,32,20)
1-pbeta(.5,32,20)
1-pbeta(.8,32,20)
qbeta(.025,32,20)
qbeta(.975,32,20)
# 7) Estimate by simulation: draw 1,000 samples from each and see how often
#    we observe theta1>theta2
theta1=rbeta(1000,41,11)
theta2=rbeta(1000,32,20)
mean(theta1>theta2)
# Note for other distributions:
# dgamma,pgamma,qgamma,rgamma
# dnorm,pnorm,qnorm,rnorm
plot(theta,dbeta(theta,1,1),type="l")
plot(theta,dbeta(theta,4,2),type="l")
plot(theta,dbeta(theta,8,4),type="l")
library(shiny); print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv5.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv6-2-2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificity/VisualizeSensitivityAndSpecificityShinyAppv6.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7-2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.R')$value)
shiny::runApp('Documents/DEC WORK/Shiny/Sample Size shiny app/Current')
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
shiny::runApp('Documents/DEC WORK/Shiny/Sample Size shiny app/Current')
shiny::runApp('Documents/DEC WORK/Shiny/Sample Size shiny app/Current')
shiny::runApp('Documents/DEC WORK/Shiny/Sample Size shiny app/Current')
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Downloads/VisualizeSensitivityAndSpecificityShinyAppv7.2.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
x = seq(5,15,length = input$n)
x = seq(5,15,length = 100)
y = dnorm(x,mean = 10,sd = 3)
distdf <- data.frame(x,y)
distri <- ggplot(data = distdf, aes(x = x, y = y))
distri <- distri + geom_line
distri <- distri + geom_line()
distri
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
print(source('Documents/DEC WORK/Shiny/VisualizeSensitivityAndSpecificityROC.R')$value)
shiny::runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
if (!require("data.table")) {
install.packages("data.table", repos="http://cran.rstudio.com/")
library("data.table")
}
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
rsconnect::setAccountInfo(name='decncltools',
token='87C244223B18277D5DB5F952164AE4D9',
secret='<SECRET>')
library(rsconnect)
rsconnect::deployApp("~/Documents/DEC WORK/Shiny/R Tools/R-tools/Teaching/ClinicalAccuracyAndUtility/App.r")
rsconnect::setAccountInfo(name='decncltools',
token='87C244223B18277D5DB5F952164AE4D9',
secret='<SECRET>')
library(rsconnect)
rsconnect::deployApp("~/Documents/DEC WORK/Shiny/R Tools/R-tools/Teaching/ClinicalAccuracyAndUtility/App.r")
library(rsconnect)
rsconnect::deployApp("~/Documents/DEC WORK/Shiny/R Tools/R-tools/Teaching/ClinicalAccuracyAndUtility/")
rsconnect::setAccountInfo(name='decncltools', token='87C244223B18277D5DB5F952164AE4D9', secret='JBl3sTYzzNC6IiXR906QJh9ofQPE/VNgoeVQ3DbL')
library(rsconnect)
rsconnect::deployApp("~/Documents/DEC WORK/Shiny/R Tools/R-tools/Teaching/ClinicalAccuracyAndUtility/")
library(proportion)
library(rsconnect)
rsconnect::deployApp("~/Documents/DEC WORK/Shiny/R Tools/R-tools/Teaching/ClinicalAccuracyAndUtility/")
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
library(PropCIs)
if (!require("PropCIs")) {
install.packages("PropCIs", repos="http://cran.rstudio.com/")
library("PropCIs")
}
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
library(rsconnect)
rsconnect::deployApp("~/Documents/DEC WORK/Shiny/R Tools/R-tools/Teaching/ClinicalAccuracyAndUtility/")
shiny::runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/TestAccuracy')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/TestAccuracy')
runApp('Documents/DEC WORK/Shiny/R tools/R-tools/Teaching/ClinicalAccuracyAndUtility')
` + ` <- `-`
1+1
library(shiny); runApp('Documents/DEC WORK/FH/Current2016-2017/FHfileshare/centiles/centilecalculator_datainputV2.0.R')
centile_script <- function(age, sex, chol){
# wd <- "H:/Jallens_homearea_DEC/Calculators/R/Centile calculator/"
wd <- "~/Documents/DEC WORK/FH/centiles"
setwd(wd)
if(!gamlass_centiles){
if(sex == "Male") centiles <- cm
if(sex == "Female") centiles <- cw
age_group <- 0
age_group <- ifelse(age <= 16, 1,age_group)
age_group <- ifelse(age >= 16 & age <= 24, 2, age_group)
age_group <- ifelse(age >= 25 & age <= 34, 3, age_group)
age_group <- ifelse(age >= 35 & age <= 44, 4, age_group)
age_group <- ifelse(age >= 45 & age <= 54, 5, age_group)
age_group <- ifelse(age >= 55 & age <= 64, 6, age_group)
age_group <- ifelse(age >= 65 & age <= 74, 7, age_group)
age_group <- ifelse(age >= 75, 8, age_group)
centile <- "NULL"
for (i in 1:8)
{
centile <- ifelse(age_group == i & nonhdl >= centiles[i,9], 100, centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,8] & nonhdl < centiles[i,9], "99-100", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,7]& nonhdl < centiles[i,8], "95-99", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,6]& nonhdl < centiles[i,7], "90-95", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,5]& nonhdl < centiles[i,6], "80-90", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,4]& nonhdl < centiles[i,5], "75-80", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,3]& nonhdl < centiles[i,4], "50-75", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,2]& nonhdl < centiles[i,3], "25-50", centile)
centile <- ifelse(age_group == i & nonhdl < centiles[i,2] , "<25", centile)
}
}
if (gamlass_centiles){
if(sex == "Male" &  chol == "nonHDL") centiles <- gcm
if(sex == "Female" & chol == "nonHDL") centiles <- gcw
if(sex == "Male" &  chol == "TC") centiles <- TCcm
if(sex == "Female" & chol == "TC") centiles <- TCcw
centiles$X <- NULL
rownames(centiles) <- centiles$age - 15
ageindex <- age - 15
ageindex[ageindex < 0] <- 0
centile <- "NULL"
if(chol == "nonhdl") valuechol <- nonhdl
if(chol == "TC") valuechol <- totchol
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,8], ">99.5", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,7]& valuechol < centiles[ageindex,8], "99-99.5", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex ,6]& valuechol < centiles[ageindex,7], "97.5-99", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,5]& valuechol < centiles[ageindex,6], "95-97.5", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,4] & valuechol < centiles[ageindex,5], "90-95", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,3]& valuechol < centiles[ageindex,4], "80-90", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,2]& valuechol < centiles[ageindex,3], "75-80", centile)
centile <- ifelse(ageindex >0 & valuechol < centiles[ageindex,2], "<75", centile)
}
# plots
centiles <- as.data.frame(centiles)
centiles <- centiles[with(centiles,order(age)), ]
dist <- ggplot(centiles, aes(x = age, y = X75., colour = "red"))
dist <- dist + geom_line(na.rm = TRUE)   + geom_line(aes(x = age, y = X80., colour = "blue")) +
geom_line(aes(x = age, y = X90., colour = "green")) + geom_line(aes(x = age, y = X95., colour = "orange"))+
geom_line(aes(x = age, y = X97.5., colour = "purple"))+
geom_line(aes(x = age, y = X99., colour = "cyan")) + geom_line(aes(x = age, y = X99.5., colour = "brown")) +
xlim(0,120)+ ylab("chol (mmol/L)") +     xlab("Age")
# centile =
#   data.frame(
#     Name = c("Age", "Sex", "nonHDL","Centile band"),
#     Value = c(age, sex, nonhdl,centile))
return(centile)
}
cm <- read.csv("malecentiles.csv")
cw <- read.csv("femalecentiles.csv")
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
TCcm <- read.csv("malecentiles_TC.csv")
TCcw <-read.csv("femalecentiles_TC.csv")
gamlass_centiles <- TRUE
wd <- "~/Documents/DEC WORK/FH/Current2016-2017/FHfileshare/centiles"
cm <- read.csv("malecentiles.csv")
cw <- read.csv("femalecentiles.csv")
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
TCcm <- read.csv("malecentiles_TC.csv")
TCcw <-read.csv("femalecentiles_TC.csv")
wd <- "~/Documents/DEC WORK/FH/centiles"
setwd(wd)
wd <- "~/Documents/DEC WORK/FH/Current2016-2017/FHfileshare/centiles"
setwd(wd)
cm <- read.csv("malecentiles.csv")
cw <- read.csv("femalecentiles.csv")
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
TCcm <- read.csv("malecentiles_TC.csv")
TCcw <-read.csv("femalecentiles_TC.csv")
if(!gamlass_centiles){
if(sex == "Male") centiles <- cm
if(sex == "Female") centiles <- cw
age_group <- 0
age_group <- ifelse(age <= 16, 1,age_group)
age_group <- ifelse(age >= 16 & age <= 24, 2, age_group)
age_group <- ifelse(age >= 25 & age <= 34, 3, age_group)
age_group <- ifelse(age >= 35 & age <= 44, 4, age_group)
age_group <- ifelse(age >= 45 & age <= 54, 5, age_group)
age_group <- ifelse(age >= 55 & age <= 64, 6, age_group)
age_group <- ifelse(age >= 65 & age <= 74, 7, age_group)
age_group <- ifelse(age >= 75, 8, age_group)
centile <- "NULL"
for (i in 1:8)
{
centile <- ifelse(age_group == i & nonhdl >= centiles[i,9], 100, centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,8] & nonhdl < centiles[i,9], "99-100", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,7]& nonhdl < centiles[i,8], "95-99", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,6]& nonhdl < centiles[i,7], "90-95", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,5]& nonhdl < centiles[i,6], "80-90", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,4]& nonhdl < centiles[i,5], "75-80", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,3]& nonhdl < centiles[i,4], "50-75", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,2]& nonhdl < centiles[i,3], "25-50", centile)
centile <- ifelse(age_group == i & nonhdl < centiles[i,2] , "<25", centile)
}
}
if (gamlass_centiles){
if(sex == "Male" &  chol == "nonHDL") centiles <- gcm
if(sex == "Female" & chol == "nonHDL") centiles <- gcw
if(sex == "Male" &  chol == "TC") centiles <- TCcm
if(sex == "Female" & chol == "TC") centiles <- TCcw
centiles$X <- NULL
rownames(centiles) <- centiles$age - 15
ageindex <- age - 15
ageindex[ageindex < 0] <- 0
centile <- "NULL"
if(chol == "nonhdl") valuechol <- nonhdl
if(chol == "TC") valuechol <- totchol
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,8], ">99.5", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,7]& valuechol < centiles[ageindex,8], "99-99.5", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex ,6]& valuechol < centiles[ageindex,7], "97.5-99", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,5]& valuechol < centiles[ageindex,6], "95-97.5", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,4] & valuechol < centiles[ageindex,5], "90-95", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,3]& valuechol < centiles[ageindex,4], "80-90", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,2]& valuechol < centiles[ageindex,3], "75-80", centile)
centile <- ifelse(ageindex >0 & valuechol < centiles[ageindex,2], "<75", centile)
}
# plots
centiles <- as.data.frame(centiles)
centiles <- centiles[with(centiles,order(age)), ]
dist <- ggplot(centiles, aes(x = age, y = X75., colour = "red"))
dist <- dist + geom_line(na.rm = TRUE)   + geom_line(aes(x = age, y = X80., colour = "blue")) +
geom_line(aes(x = age, y = X90., colour = "green")) + geom_line(aes(x = age, y = X95., colour = "orange"))+
geom_line(aes(x = age, y = X97.5., colour = "purple"))+
geom_line(aes(x = age, y = X99., colour = "cyan")) + geom_line(aes(x = age, y = X99.5., colour = "brown")) +
xlim(0,120)+ ylab("chol (mmol/L)") +     xlab("Age")
# centile =
#   data.frame(
#     Name = c("Age", "Sex", "nonHDL","Centile band"),
#     Value = c(age, sex, nonhdl,centile))
return(centile)
}
centile_script <- function(age, sex, chol){
if(!gamlass_centiles){
if(sex == "Male") centiles <- cm
if(sex == "Female") centiles <- cw
age_group <- 0
age_group <- ifelse(age <= 16, 1,age_group)
age_group <- ifelse(age >= 16 & age <= 24, 2, age_group)
age_group <- ifelse(age >= 25 & age <= 34, 3, age_group)
age_group <- ifelse(age >= 35 & age <= 44, 4, age_group)
age_group <- ifelse(age >= 45 & age <= 54, 5, age_group)
age_group <- ifelse(age >= 55 & age <= 64, 6, age_group)
age_group <- ifelse(age >= 65 & age <= 74, 7, age_group)
age_group <- ifelse(age >= 75, 8, age_group)
centile <- "NULL"
for (i in 1:8)
{
centile <- ifelse(age_group == i & nonhdl >= centiles[i,9], 100, centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,8] & nonhdl < centiles[i,9], "99-100", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,7]& nonhdl < centiles[i,8], "95-99", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,6]& nonhdl < centiles[i,7], "90-95", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,5]& nonhdl < centiles[i,6], "80-90", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,4]& nonhdl < centiles[i,5], "75-80", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,3]& nonhdl < centiles[i,4], "50-75", centile)
centile <- ifelse(age_group == i & nonhdl >= centiles[i,2]& nonhdl < centiles[i,3], "25-50", centile)
centile <- ifelse(age_group == i & nonhdl < centiles[i,2] , "<25", centile)
}
}
if (gamlass_centiles){
if(sex == "Male" &  chol == "nonHDL") centiles <- gcm
if(sex == "Female" & chol == "nonHDL") centiles <- gcw
if(sex == "Male" &  chol == "TC") centiles <- TCcm
if(sex == "Female" & chol == "TC") centiles <- TCcw
centiles$X <- NULL
rownames(centiles) <- centiles$age - 15
ageindex <- age - 15
ageindex[ageindex < 0] <- 0
centile <- "NULL"
if(chol == "nonhdl") valuechol <- nonhdl
if(chol == "TC") valuechol <- totchol
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,8], ">99.5", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,7]& valuechol < centiles[ageindex,8], "99-99.5", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex ,6]& valuechol < centiles[ageindex,7], "97.5-99", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,5]& valuechol < centiles[ageindex,6], "95-97.5", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,4] & valuechol < centiles[ageindex,5], "90-95", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,3]& valuechol < centiles[ageindex,4], "80-90", centile)
centile <- ifelse(ageindex >0 & valuechol >= centiles[ageindex,2]& valuechol < centiles[ageindex,3], "75-80", centile)
centile <- ifelse(ageindex >0 & valuechol < centiles[ageindex,2], "<75", centile)
}
# plots
centiles <- as.data.frame(centiles)
centiles <- centiles[with(centiles,order(age)), ]
dist <- ggplot(centiles, aes(x = age, y = X75., colour = "red"))
dist <- dist + geom_line(na.rm = TRUE)   + geom_line(aes(x = age, y = X80., colour = "blue")) +
geom_line(aes(x = age, y = X90., colour = "green")) + geom_line(aes(x = age, y = X95., colour = "orange"))+
geom_line(aes(x = age, y = X97.5., colour = "purple"))+
geom_line(aes(x = age, y = X99., colour = "cyan")) + geom_line(aes(x = age, y = X99.5., colour = "brown")) +
xlim(0,120)+ ylab("chol (mmol/L)") +     xlab("Age")
# centile =
#   data.frame(
#     Name = c("Age", "Sex", "nonHDL","Centile band"),
#     Value = c(age, sex, nonhdl,centile))
return(centile)
}
runApp('centilecalculator_datainputV2.0.R')
runApp('centilecalculator v0.2.R')
runApp('~/Documents/DEC WORK/Shiny/R tools/R-tools/Project specific/FH/centiles/centilecalculator_datainput.R')
runApp('centilecalculator_datainputV2.0.R')
runApp('centilecalculator_datainputV2.0.R')
