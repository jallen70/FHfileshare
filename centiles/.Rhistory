g0 <- plot.roc(modeldata2$outcome, modeldata2$prob, levels=c("NMD", "MD"), percent=TRUE, ci=TRUE,
print.auc = TRUE, print.auc.y = 35, add = TRUE, col = "red" )
plot(ci.se(g0, sensitivities=seq(0, 100, 5)), # ci of specificity
type="bars", col = "red") # print this one as bars
legend(85,20,legend=c ("Components of DLCNS", "Replace LDL levels with continuous LDL", "Replace LDL levels with non-HDL-C percentiles",
"Replace LDL levels with MoM"),col = c("seagreen4", "orange", "turquoise3","red" ),  pch = 16,  bty = "n")
g0
print(g0)
dev.off()
colnames(mydata)
colnames(mydata1)
head(mydata)
head(mydata1)
dutchscore_md <- ggplot(mydata, aes(x=dutchscore, colour = outcome, fill = outcome))
dutchscore_md <- dutchscore_md + geom_hist(position="dodge", alpha = 0.75) +
ylab("Frequency")
xlab("Dutch Lipid Clinic Network Score")  + theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))
dutchscore_md <- ggplot(mydata, aes(x=dutchscore, colour = outcome, fill = outcome))
dutchscore_md <- dutchscore_md + geom_histogram(position="dodge", alpha = 0.75) +
ylab("Frequency")
xlab("Dutch Lipid Clinic Network Score")  + theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))
dutchscore_md
colnames(total_study)
dutchscore_md <- ggplot(total_study, aes(x=Dutch.score, colour = outcome, fill = outcome))
dutchscore_md <- dutchscore_md + geom_histogram(position="dodge", alpha = 0.75) +
ylab("Frequency")
xlab("Dutch Lipid Clinic Network Score")  + theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))
dutchscore_md <- ggplot(mydata, aes(x=DLCN, colour = outcome, fill = outcome))
dutchscore_md <- dutchscore_md + geom_histogram(position="dodge", alpha = 0.75) +
ylab("Frequency")
xlab("Dutch Lipid Clinic Network Score")  + theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))
#use dutchscore bands
dutchscore_md <- ggplot(mydata, aes(x=DLCN, colour = outcome, fill = outcome))
dutchscore_md <- dutchscore_md + geom_histogram(position="dodge", alpha = 0.75) +
ylab("Frequency")
xlab("Dutch Lipid Clinic Network Score")  + theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))
mydata$DLCN
dutchscore_md
dutchscore_md <- ggplot(mydata, aes(x=DLCN, colour = outcome, fill = outcome))
dutchscore_md <- dutchscore_md + geom_histogram(position="dodge", alpha = 0.75, stat = "count") +
ylab("Frequency")
xlab("Dutch Lipid Clinic Network Score")  + theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))
LDL_freq <- ggplot(data = total_study, aes(x=LDL))
LDL_freq <- LDL_freq + geom_bar() +
geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+5,
label =paste(labs, "%", sep= ""))) + #, "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") ) ) +
geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+2,
label =paste(sep= "", "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") )) +
geom_bar(fill="cyan3") + ylab("Number of probands") +
xlab("Fasting LDL Cholesterol") +
geom_bar(data = total_study[total_study$Final_result == "MD",], aes(x=LDL,  fill = "lightcoral")) +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  +  scale_fill_discrete(labels = "MD", "")
LDL_freq
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN))
dutchbands_md  <- dutchbands_md  + geom_bar() +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+5,
#                                      label =paste(labs, "%", sep= ""))) + #, "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") ) ) +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+2,
#                                      label =paste(sep= "", "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") )) +
geom_bar(fill="cyan3") + ylab("Number of probands") +
xlab("Fasting LDL Cholesterol") +
geom_bar(data = mydata[mydata$outcome == "MD",], aes(x=LDL,  fill = "lightcoral")) +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  +  scale_fill_discrete(labels = "MD", "")
dutchbands_md
#use dutchscore bands
dutchscore_md <- ggplot(mydata, aes(x=DLCN, colour = outcome, fill = outcome))
dutchscore_md <- dutchscore_md + geom_histogram(position="dodge", alpha = 0.75, stat = "count") +
ylab("Frequency")
xlab("Dutch Lipid Clinic Network Score")  + theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN))
dutchbands_md  <- dutchbands_md  + geom_bar() +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+5,
#                                      label =paste(labs, "%", sep= ""))) + #, "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") ) ) +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+2,
#                                      label =paste(sep= "", "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") )) +
geom_bar(fill="cyan3") + ylab("Number of probands") +
xlab("Dutch Score") +
geom_bar(data = mydata[mydata$outcome == "MD",], aes(x=LDL,  fill = "lightcoral")) +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  +  scale_fill_discrete(labels = "MD", "")
dutchbands_md
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(aes(y = ..count../sum(..count..)),position="dodge", alpha = 1) +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+5,
#                                      label =paste(labs, "%", sep= ""))) + #, "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") ) ) +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+2,
#                                      label =paste(sep= "", "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") )) +
ylab("Number of probands") +
xlab("Dutch Score") +
geom_bar(data = mydata[mydata$outcome == "MD",], aes(x=LDL,  fill = "lightcoral")) +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  +  scale_fill_discrete(labels = "MD", "")
dutchbands_md
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(aes(y = ..count../sum(..count..)),position="dodge", alpha = 1) +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+5,
#                                      label =paste(labs, "%", sep= ""))) + #, "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") ) ) +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+2,
#                                      label =paste(sep= "", "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") )) +
ylab("Number of probands") +
xlab("Dutch Score") +
# geom_bar(data = mydata[mydata$outcome == "MD",], aes(x=LDL,  fill = "lightcoral")) +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  +  scale_fill_discrete(labels = "MD", "")
dutchbands_md
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(aes(y = ..count../sum(..count..)),position="dodge", alpha = 1)
dutchbands_md
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(aes(y = ..count../sum(..count..)),position="dodge", alpha = 1) +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+5,
#                                      label =paste(labs, "%", sep= ""))) + #, "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") ) ) +
# geom_text(data = pickup_LDLlevel,aes(x = LDL, y =num_LDLlevel+2,
#                                      label =paste(sep= "", "(",num_LDLlevel_pos, "/", num_LDLlevel, ")") )) +
ylab("Number of probands") +
xlab("Dutch Score") +
# geom_bar(data = mydata[mydata$outcome == "MD",], aes(x=LDL,  fill = "lightcoral")) +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))
dutchbands_md
dutchbands_md <- ggplot(data = mydata, aes(x=gamlass_centiles, , colour = outcome, fill = outcome))
percentiles_md <- ggplot(data = mydata, aes(x=gamlass_centiles, , colour = outcome, fill = outcome))
centiles_md <- ggplot(data = mydata, aes(x=gamlass_centiles, , colour = outcome, fill = outcome))
centiles_md  <- centiles_md  +geom_bar(aes(y = ..count../sum(..count..)),position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Percentile range") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
centiles_md
centiles_md <- ggplot(data = mydata, aes(x=gamlass_centile, , colour = outcome, fill = outcome))
centiles_md  <- centiles_md  +geom_bar(aes(y = ..count../sum(..count..)),position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Percentile range") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
centiles_md
centiles_md <- ggplot(data = mydata, aes(x=gamlass_centile, , colour = outcome, fill = outcome))
centiles_md  <- centiles_md  +geom_bar(),position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Percentile range") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
centiles_md
centiles_md <- ggplot(data = mydata, aes(x=gamlass_centile, , colour = outcome, fill = outcome))
centiles_md  <- centiles_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Percentile range") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
centiles_md
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(),position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
dutchbands_md
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
dutchbands_md
centiles_md <- ggplot(data = mydata, aes(x=gamlass_centile, , colour = outcome, fill = outcome))
centiles_md  <- centiles_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Percentile range") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
centiles_md
mypath <- file.path(paste(figfilepath, "dutchscorebands", ".pdf", sep=""))
pdf(mypath, paper = "a4r", width = 11, height = 8)
mypath <- file.path(paste(figfilepath, "centilecorebands", ".pdf", sep=""))
pdf(mypath, paper = "a4r", width = 11, height = 8)
mypath <- file.path(paste(figfilepath, "centilecorebands", ".png", sep=""))
pdf(mypath, paper = "a4r", width = 11, height = 8)
mypath <- file.path(paste(figfilepath, "centilecorebands", ".png", sep=""))
png(mypath, paper = "a4r", width = 11, height = 8)
mypath <- file.path(paste(figfilepath, "centilecorebands", ".png", sep=""))
png(mypath) #, paper = "a4r", width = 11, height = 8)
name <- paste(figfilepath, "dutchscorebands", ".png", sep="")
dev.copy(png,name)
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(dutchbands_md)
dev.off()
name <- paste(figfilepath, "centilecorebands", ".png", sep="")
dev.copy(png,name)
centiles_md <- ggplot(data = mydata, aes(x=gamlass_centile, , colour = outcome, fill = outcome))
centiles_md  <- centiles_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Percentile range") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(centiles_md)
dev.off()
levels(mydata$DLCN)
mydata <- mydata %>% mutate(DLCN = factor(DLCN, levels = c("Unknown", "2 - 6" ,  "7 - 9" ,  "10 - 12" ,"13 - 16" )))
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(dutchbands_md)
dev.off()
name <- paste(figfilepath, "dutchscorebands", ".png", sep="")
dev.copy(png,name)
mydata <- mydata %>% mutate(DLCN = factor(DLCN, levels = c("Unknown", "2 - 6" ,  "7 - 9" ,  "10 - 12" ,"13 - 16" )))
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(dutchbands_md)
dev.off()
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +  ylim(0,80) +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(dutchbands_md)
dev.off()
name <- paste(figfilepath, "dutchscorebands", ".png", sep="")
dev.copy(png,name)
mydata <- mydata %>% mutate(DLCN = factor(DLCN, levels = c("Unknown", "2 - 6" ,  "7 - 9" ,  "10 - 12" ,"13 - 16" )))
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN, , colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +  ylim(0,80) +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16, angle = 45),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(dutchbands_md)
dev.off()
name <- paste(figfilepath, "centilecorebands", ".png", sep="")
dev.copy(png,name)
centiles_md <- ggplot(data = mydata, aes(x=gamlass_centile, , colour = outcome, fill = outcome))
centiles_md  <- centiles_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands")+  ylim(0,80) +
xlab("Percentile range") +
theme(axis.text=element_text(size=16,angle = 45),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(centiles_md)
dev.off()
}
par(mfrow=c(2,2))
grid.arrange(dutchbands_md,centiles_md
dev.off()
par(mfrow=c(2,2))
grid.arrange(dutchbands_md,centiles_md)
dev.off()
genrefine(figfilepath,mydata)
debugSource('Z:/DEC methods/tools - R/Working_project_folders/NCL_DEC0002 Familial hypercholesterolaemia/Current2016-2017/functions/genrefine.R')
genrefine(figfilepath,mydata)
dutchscore_md <- ggplot(mydata, aes(x=dutchscore, colour = outcome, fill = outcome))
dutchscore_md <- dutchscore_md + geom_histogram(position="dodge", alpha = 0.75) +
ylab("Frequency")
xlab("Dutch Lipid Clinic Network Score")  + theme(axis.text=element_text(size=16),
axis.title=element_text(size=16,face="bold"))
dutchscore_md
source('Z:/DEC methods/tools - R/Working_project_folders/NCL_DEC0002 Familial hypercholesterolaemia/Current2016-2017/functions/genrefine.R')
source("functions/genrefine.R")
source('Z:/DEC methods/tools - R/Working_project_folders/NCL_DEC0002 Familial hypercholesterolaemia/Current2016-2017/functions/genrefine.R')
genrefine(figfilepath,mydata)
name <- paste(figfilepath, "dutchscorebands", ".png", sep="")
dev.copy(png,name)
mydata <- mydata %>% mutate(DLCN = factor(DLCN, levels = c("Unknown", "2 - 6" ,  "7 - 9" ,  "10 - 12" ,"13 - 16" )))
par(mfrow=c(1,2))
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN,colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +  ylim(0,80) +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16, angle = 45),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(dutchbands_md)
dev.off()
name <- paste(figfilepath, "centilecorebands", ".png", sep="")
dev.copy(png,name)
centiles_md <- ggplot(data = mydata, aes(x=gamlass_centile, colour = outcome, fill = outcome))
centiles_md  <- centiles_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands")+  ylim(0,80) +
xlab("Percentile range") +
theme(axis.text=element_text(size=16,angle = 45),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(centiles_md)
dev.off()
par(mfrow=c(1,2))
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN,colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +  ylim(0,80) +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16, angle = 45),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
dutchbands_md
dutchbands_md
par(mfrow=c(1,2))
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN,colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +  ylim(0,80) +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16, angle = 45),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(dutchbands_md)
name <- paste(figfilepath, "dutchscorebands", ".png", sep="")
dev.copy(png,name)
mydata <- mydata %>% mutate(DLCN = factor(DLCN, levels = c("Unknown", "2 - 6" ,  "7 - 9" ,  "10 - 12" ,"13 - 16" )))
dutchbands_md <- ggplot(data = mydata, aes(x=DLCN,colour = outcome, fill = outcome))
dutchbands_md  <- dutchbands_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands") +  ylim(0,80) +
xlab("Dutch Score") +
theme(axis.text=element_text(size=16, angle = 45),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(dutchbands_md)
dev.off()
name <- paste(figfilepath, "centilecorebands", ".png", sep="")
dev.copy(png,name)
centiles_md <- ggplot(data = mydata, aes(x=gamlass_centile, colour = outcome, fill = outcome))
centiles_md  <- centiles_md  +geom_bar(position="dodge", alpha = 1) +
ylab("Number of probands")+  ylim(0,80) +
xlab("Percentile range") +
theme(axis.text=element_text(size=16,angle = 45),
axis.title=element_text(size=16,face="bold"))  #+  scale_fill_discrete(labels = "MD", "")
print(centiles_md)
dev.off()
genrefine(figfilepath,mydata)
wd <- "~/Documents/DEC WORK/FH/Current2016-2017/FHfileshare/centiles"
setwd(wd)
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
gcm <- as.data.frame(gcm)
gcm <- gcm[with(gcm,order(age)), ]
distm <- ggplot(gcm,  aes(x = age, y = X75., color = "red"))
distm <- distm + geom_line(colour = "red", na.rm = TRUE)   + geom_line(colour = "blue",aes(x = age, y = X80., color = "blue")) +
geom_line(colour = "seagreen3", aes(x = age, y = X90., color = "seagreen3")) + geom_line(colour = "orange", aes(x = age, y = X95., color = "orange"))+
geom_line(colour = "purple",aes(x = age, y = X97.5., color = "purple"))+
geom_line(colour = "turquoise4",aes(x = age, y = X99., color = "turquoise4")) + geom_line(colour = "brown",aes(x = age, y = X99.5., color = "brown")) +
#  scale_color_manual(name = "Percentile", values = c("75"= "red", "80" = "blue", "90"= "green4", "95" = "orange", "97.5" = "purple", "99" = "turquoise4", "99.5" = "brown")) +
xlim(0,124)+ ylim(3.1, 8.5) + ylab("non-HDL-C (mmol/L)") +     xlab("Age")  +
geom_hline(yintercept = 5.9) +
annotate("text", label = "75%",colour = "red", size = 6, x = 115, y = 3.75) +
annotate("text", label = "80%",colour = "blue", size = 6,  x = 115, y = 4.25) +
annotate("text", label = "90%",colour = "seagreen3", size = 6,  x = 115, y = 4.75) +
annotate("text", label = "95%",colour = "orange", size = 6, x = 115, y = 5.25) +
annotate("text", label = "97.5%",colour = "purple", size = 6,  x = 115, y = 5.6) +
annotate("text", label = "99%",colour = "turquoise4", size = 6,  x = 115, y = 6.15) +
annotate("text", label = "99.5%",colour = "brown", size = 6,  x = 115, y = 6.75) +
annotate("text", label = "Current cut-off", size = 4, x = 10, y = 6.1) +
ggtitle("Male non-HDL-C percentile plots")
distm
wd <- "~/Documents/DEC WORK/FH/Current2016-2017/FHfileshare/centiles"
setwd(wd)
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
wd <- "~/Documents/DEC WORK/FH/Current2016-2017/FHfileshare/centiles"
setwd(wd)
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
gcm <- as.data.frame(gcm)
gcm <- gcm[with(gcm,order(age)), ]
wd <- "Z:/DEC methods/tools - R/Working_project_folders/NCL_DEC0002 Familial hypercholesterolaemia/Current2016-2017/FHfileshare/centiles"
#wd <- "~/Documents/DEC WORK/FH/Current2016-2017/FHfileshare/centiles"
setwd(wd)
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
gcm <- as.data.frame(gcm)
gcm <- gcm[with(gcm,order(age)), ]
distm <- ggplot(gcm,  aes(x = age, y = X75., color = "red"))
distm <- distm + geom_line(colour = "red", na.rm = TRUE)   + geom_line(colour = "blue",aes(x = age, y = X80., color = "blue")) +
geom_line(colour = "seagreen3", aes(x = age, y = X90., color = "seagreen3")) + geom_line(colour = "orange", aes(x = age, y = X95., color = "orange"))+
geom_line(colour = "purple",aes(x = age, y = X97.5., color = "purple"))+
geom_line(colour = "turquoise4",aes(x = age, y = X99., color = "turquoise4")) + geom_line(colour = "brown",aes(x = age, y = X99.5., color = "brown")) +
#  scale_color_manual(name = "Percentile", values = c("75"= "red", "80" = "blue", "90"= "green4", "95" = "orange", "97.5" = "purple", "99" = "turquoise4", "99.5" = "brown")) +
xlim(0,124)+ ylim(3.1, 8.5) + ylab("non-HDL-C (mmol/L)") +     xlab("Age")  +
geom_hline(yintercept = 5.9) +
annotate("text", label = "75%",colour = "red", size = 6, x = 115, y = 3.75) +
annotate("text", label = "80%",colour = "blue", size = 6,  x = 115, y = 4.25) +
annotate("text", label = "90%",colour = "seagreen3", size = 6,  x = 115, y = 4.75) +
annotate("text", label = "95%",colour = "orange", size = 6, x = 115, y = 5.25) +
annotate("text", label = "97.5%",colour = "purple", size = 6,  x = 115, y = 5.6) +
annotate("text", label = "99%",colour = "turquoise4", size = 6,  x = 115, y = 6.15) +
annotate("text", label = "99.5%",colour = "brown", size = 6,  x = 115, y = 6.75) +
annotate("text", label = "Current cut-off", size = 4, x = 10, y = 6.1) +
ggtitle("Male non-HDL-C percentile plots")
distm
_
wd <- "Z:/DEC methods/tools - R/Working_project_folders/NCL_DEC0002 Familial hypercholesterolaemia/Current2016-2017/FHfileshare/centiles"
#wd <- "~/Documents/DEC WORK/FH/Current2016-2017/FHfileshare/centiles"
setwd(wd)
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
gcm <- as.data.frame(gcm)
gcm <- gcm[with(gcm,order(age)), ]
distm <- ggplot(gcm,  aes(x = age, y = X75., color = "red"))
distm <- ggplot(gcm,  aes(x = age, y = X75., color = "red"))
distm <- distm + geom_line(colour = "red", na.rm = TRUE)   + geom_line(colour = "blue",aes(x = age, y = X80., color = "blue")) +
geom_line(colour = "seagreen3", aes(x = age, y = X90., color = "seagreen3")) + geom_line(colour = "orange", aes(x = age, y = X95., color = "orange"))+
geom_line(colour = "purple",aes(x = age, y = X97.5., color = "purple"))+
geom_line(colour = "turquoise4",aes(x = age, y = X99., color = "turquoise4")) + geom_line(colour = "brown",aes(x = age, y = X99.5., color = "brown")) +
#  scale_color_manual(name = "Percentile", values = c("75"= "red", "80" = "blue", "90"= "green4", "95" = "orange", "97.5" = "purple", "99" = "turquoise4", "99.5" = "brown")) +
xlim(0,124)+ ylim(3.1, 8.5) + ylab("non-HDL-C (mmol/L)") +     xlab("Age")  +
geom_hline(yintercept = 5.9) +
annotate("text", label = "75%",colour = "red", size = 6, x = 115, y = 3.75) +
annotate("text", label = "80%",colour = "blue", size = 6,  x = 115, y = 4.25) +
annotate("text", label = "90%",colour = "seagreen3", size = 6,  x = 115, y = 4.75) +
annotate("text", label = "95%",colour = "orange", size = 6, x = 115, y = 5.25) +
annotate("text", label = "97.5%",colour = "purple", size = 6,  x = 115, y = 5.6) +
annotate("text", label = "99%",colour = "turquoise4", size = 6,  x = 115, y = 6.15) +
annotate("text", label = "99.5%",colour = "brown", size = 6,  x = 115, y = 6.75) +
annotate("text", label = "Current cut-off", size = 4, x = 10, y = 6.1) +
ggtitle("Male non-HDL-C percentile plots")
distm
distm
dev.off()
wd <- "Z:/DEC methods/tools - R/Working_project_folders/NCL_DEC0002 Familial hypercholesterolaemia/Current2016-2017/FHfileshare/centiles"
setwd(wd)
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
gcm <- as.data.frame(gcm)
gcm <- gcm[with(gcm,order(age)), ]
distm <- ggplot(gcm,  aes(x = age, y = X75., color = "red"))
distm <- distm + geom_line(colour = "red", na.rm = TRUE)   + geom_line(colour = "blue",aes(x = age, y = X80., color = "blue")) +
geom_line(colour = "seagreen3", aes(x = age, y = X90., color = "seagreen3")) + geom_line(colour = "orange", aes(x = age, y = X95., color = "orange"))+
geom_line(colour = "purple",aes(x = age, y = X97.5., color = "purple"))+
geom_line(colour = "turquoise4",aes(x = age, y = X99., color = "turquoise4")) + geom_line(colour = "brown",aes(x = age, y = X99.5., color = "brown")) +
#  scale_color_manual(name = "Percentile", values = c("75"= "red", "80" = "blue", "90"= "green4", "95" = "orange", "97.5" = "purple", "99" = "turquoise4", "99.5" = "brown")) +
xlim(0,124)+ ylim(3.1, 8.5) + ylab("non-HDL-C (mmol/L)") +     xlab("Age")  +
geom_hline(yintercept = 5.9) +
annotate("text", label = "75%",colour = "red", size = 6, x = 115, y = 3.75) +
annotate("text", label = "80%",colour = "blue", size = 6,  x = 115, y = 4.25) +
annotate("text", label = "90%",colour = "seagreen3", size = 6,  x = 115, y = 4.75) +
annotate("text", label = "95%",colour = "orange", size = 6, x = 115, y = 5.25) +
annotate("text", label = "97.5%",colour = "purple", size = 6,  x = 115, y = 5.6) +
annotate("text", label = "99%",colour = "turquoise4", size = 6,  x = 115, y = 6.15) +
annotate("text", label = "99.5%",colour = "brown", size = 6,  x = 115, y = 6.75) +
annotate("text", label = "Current cut-off", size = 4, x = 10, y = 6.1) +
ggtitle("Male non-HDL-C percentile plots")
distm
as.data.frame(t(gcm))
View(t(gcm))
row.names(t(gcm))
tgcmas.data.frame(t(gcm))
tgcm <- as.data.frame(t(gcm))
tgcm[1, ] <- NULL
tgcm[-c(1), ]
tgcm <- tgcm[-c(1), ]
tgcm
setwd(wd)
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
gcm <- as.data.frame(gcm)
gcm <- gcm[with(gcm,order(age)), ]
tgcm <- as.data.frame(t(gcm))
tgcm <- tgcm[-c(1), ]
tgcm
colnames(tgcm) = tgcm[1, ] # the first row will be the header
tgcm = tgcm[-1, ]          # removing the first row.
tgcm
tgcm[nrow(tgcm):1,]
write.csv(tgcm, "malenonHDLtables.csv")
setwd(wd)
gcm <- read.csv("gamlassmalecentiles.csv")
gcw <-read.csv("gamlassfemalecentiles.csv")
gcm <- as.data.frame(gcm)
gcm <- gcm[with(gcm,order(age)), ]
tgcm <- as.data.frame(t(gcm))
tgcm <- tgcm[-c(1), ]
colnames(tgcm) = tgcm[1, ] # the first row will be the header
tgcm = tgcm[-1, ]          # removing the first row.
tgcm <- tgcm[nrow(tgcm):1,]
write.csv(tgcm, "malenonHDLtables.csv")
gcw <- as.data.frame(gcw)
gcw <- gcw[with(gcw,order(age)), ]
tgcw <- as.data.frame(t(gcw))
tgcw <- tgcw[-c(1), ]
colnames(tgcw) = tgcw[1, ] # the first row will be the header
tgcw = tgcw[-1, ]          # removing the first row.
tgcw <- tgcw[nrow(tgcw):1,]
write.csv(tgcw, "femalenonHDLtables.csv")
TCcm <- read.csv("malecentiles_TC.csv")
TCcw <-read.csv("femalecentiles_TC.csv")
TCcm <- as.data.frame(TCcm)
TCcm <- TCcm[with(TCcm,order(age)), ]
tTCcm <- as.data.frame(t(TCcm))
tTCcm <- tTCcm[-c(1), ]
colnames(tTCcm) = tTCcm[1, ] # the first row will be the header
tTCcm = tTCcm[-1, ]          # removing the first row.
tTCcm <- tTCcm[nrow(tTCcm):1,]
write.csv(tTCcm, "maleTCtables.csv")
TCcw <- as.data.frame(TCcw)
TCcw <- TCcw[with(TCcw,order(age)), ]
tTCcw <- as.data.frame(t(TCcw))
tTCcw <- tTCcw[-c(1), ]
colnames(tTCcw) = tTCcw[1, ] # the first row will be the header
tTCcw = tTCcw[-1, ]          # removing the first row.
tTCcw <- tTCcw[nrow(tTCcw):1,]
write.csv(tTCcw, "femaleTCtables.csv")
